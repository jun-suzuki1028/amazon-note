# Requirements Document

## Introduction

AIを活用したAmazonランキング記事量産システム。Claude Codeを中心とした効率的なワークフローで、ペルソナ作成からDeepResearchプロンプト生成、調査結果管理、記事作成まで一連の流れを自動化します。サクラチェッカーの評価が高く、レビュー数が多い「ちゃんとした製品」のみを紹介することで、読者の信頼を獲得し、アフィリエイト収益の最大化を目指します。

本システムはClaude Code CLIベースのツールチェーンとして実装し、フロントエンドUIは不要とします。

## Alignment with Product Vision

本システムは以下の目標達成を支援します：
- **収益目標**: 月5万円のアフィリエイト収益
- **記事本数**: 週5本の高品質ランキング記事作成
- **差別化**: 独自の評価軸（サクラチェッカー + レビュー数）による信頼性の向上
- **効率化**: Claude Code中心のワークフロー自動化による運営体制の最適化

## Requirements

### Requirement 1: ペルソナ作成とDeepResearchプロンプト生成機能

**User Story:** 記事作成者として、Claude Codeを使ってターゲット読者のペルソナを作成し、そのペルソナに基づいたDeepResearch用の最適化されたプロンプトを生成したい。そうすることで、効果的なリサーチと読者のニーズに合った記事を作成できる。

#### Acceptance Criteria

1. WHEN ペルソナ作成コマンドを実行する THEN システム SHALL Claude Codeを活用してペルソナ情報（基本情報、ライフスタイル、購買行動、悩み）を体系的に収集し、構造化されたマークダウンファイルで保存する
2. WHEN DeepResearchプロンプト生成を実行する THEN システム SHALL 作成されたペルソナ情報を参照し、Gemini/DeepResearch用の具体的で効果的なプロンプトを自動生成する
3. IF プロンプトが生成される THEN システム SHALL リサーチ対象（キーワード、競合分析、製品調査）ごとに最適化されたプロンプトセットをマークダウンファイルで保存する
4. WHEN 次のフェーズに進む THEN システム SHALL 生成されたプロンプトがGemini MCPまたは手動実行で利用できる形式で準備する

### Requirement 2: DeepResearch実行と結果管理機能

**User Story:** 記事作成者として、生成されたプロンプトを使ってGemini MCPでDeepResearchを実行し（利用不可の場合は手動実行）、リサーチ結果をマークダウン形式で効率的に保存・管理したい。そうすることで、質の高いリサーチデータを記事作成に活用できる。

#### Acceptance Criteria

1. IF Gemini MCPが利用可能 THEN システム SHALL 生成されたプロンプトを使ってGemini MCPでDeepResearchを自動実行する
2. IF Gemini MCPが利用不可 THEN システム SHALL 手動実行用のプロンプト一覧とリサーチ結果入力フォーマットを提供する
3. WHEN リサーチ結果を取得する THEN システム SHALL 結果を構造化されたマークダウン形式（キーワード分析、競合分析、製品情報、トレンド情報）で自動保存する
4. WHEN サクラチェッカー確認を行う THEN システム SHALL リサーチで見つかった製品のサクラチェッカー確認用チェックリストを生成し、手動確認結果を記録するフォーマットを提供する
5. IF すべてのリサーチが完了する THEN システム SHALL 整理されたリサーチデータパッケージを記事生成フェーズで参照できる形式で準備する

### Requirement 3: 調査結果参照型記事生成機能

**User Story:** 記事作成者として、Claude Codeが保存済みのペルソナ情報とDeepResearchデータを参照して、一貫性のある高品質なランキング記事を自動生成したい。そうすることで、リサーチの価値を最大限活用した信頼性の高い記事を効率的に作成できる。

#### Acceptance Criteria

1. WHEN 記事生成を開始する THEN システム SHALL 保存されたペルソナ情報、DeepResearchデータ、製品評価データを自動読み込みし、Claude Codeのコンテキストに設定する
2. WHEN 記事構造を生成する THEN システム SHALL ペルソナの悩みに寄り添った導入文、独自評価軸に基づくランキング構造、各製品の詳細セクションを含む記事アウトラインを作成する
3. WHEN コンテンツ生成を実行する THEN システム SHALL リサーチデータを参照しながら、各製品の「良い点・悪い点」をバランス良く記載したレビュー要約を生成する
4. WHEN 記事を完成させる THEN システム SHALL ペルソナに合わせたトーンで一貫性のある記事を生成し、アフィリエイトリンク挿入箇所をマークしたマークダウンファイルで出力する
5. IF 記事生成が完了する THEN システム SHALL 生成された記事を品質チェックフェーズに渡す準備を整える

### Requirement 4: 記事品質チェック・最適化機能

**User Story:** 記事作成者として、Claude Codeで生成された記事の品質をチェックし、SEO最適化や独自性向上のための修正・追記を効率的に行いたい。そうすることで、検索エンジンと読者の両方に評価される記事を完成させることができる。

#### Acceptance Criteria

1. WHEN 品質チェックを実行する THEN システム SHALL Claude Codeで記事の誤字脱字、不自然な表現、論理的整合性を自動チェックし、問題箇所と修正提案をマークダウンコメントで付与する
2. WHEN SEO最適化チェックを行う THEN システム SHALL タイトル、見出し構造、キーワード密度、メタ情報の最適化提案を生成する
3. WHEN 独自性向上を支援する THEN システム SHALL 独自の考察、体験談、比較ポイントを追加するためのテンプレートセクションと質問プロンプトを提供する
4. WHEN 最終調整を行う THEN システム SHALL 手動修正をサポートし、修正後の品質を再チェックする機能を提供する
5. IF 品質基準をクリアする THEN システム SHALL 公開準備完了の確認と、公開用フォーマット出力機能を提供する

### Requirement 5: ワークフロー管理とプロジェクト追跡機能

**User Story:** 記事作成者として、Claude Code CLIを使ってペルソナ作成から記事完成までの全ワークフローを効率的に管理し、週5本の記事作成目標を継続的に達成したい。そうすることで、安定した品質と生産性を維持できる。

#### Acceptance Criteria

1. WHEN ワークフローを開始する THEN システム SHALL 各フェーズ（ペルソナ作成、プロンプト生成、リサーチ、記事生成、品質チェック）の状態をプロジェクト管理ファイルで追跡する
2. WHEN 各フェーズを完了する THEN システム SHALL 進捗状況をアップデートし、次フェーズへの移行条件をチェックして継続判断を支援する
3. WHEN プロジェクト状況を確認する THEN システム SHALL 作成記事数、各フェーズの所要時間、品質指標、収益予測をダッシュボード形式で表示する
4. IF 過去のデータを活用する THEN システム SHALL 過去に作成したペルソナ、プロンプト、リサーチデータの再利用可能性を分析し、効率化提案を行う
5. WHEN エラーや問題が発生する THEN システム SHALL 問題の種類を特定し、解決手順とフェーズ復旧方法をガイド表示する

## Non-Functional Requirements

### Code Architecture and Modularity
- **Single Responsibility Principle**: ペルソナ管理、プロンプト生成、リサーチ管理、記事生成、品質チェックの各機能を独立したCLIコマンドとして実装
- **Modular Design**: Claude Code核心機能、Gemini MCP連携、ファイル管理、データ変換の各コンポーネントを分離したモジュール構造
- **Dependency Management**: Claude Code CLIを核として、Gemini MCP依存は条件付きとし、マークダウンファイルベースの処理を基本とする
- **Clear Interfaces**: フェーズ間のデータ受け渡しを標準化されたマークダウンフォーマットとメタデータで実装

### Performance
- **ワークフロー完了時間**: 1記事あたり20分以内でワークフロー完了（手動確認・調整時間を含む）
- **データ処理速度**: マークダウンファイルの読み書きとデータ変換を1秒以内で実行
- **Claude Code応答時間**: ペルソナ作成、プロンプト生成、記事生成の各処理を5分以内で完了
- **Gemini MCP応答時間**: 利用可能時のGemini MCP通信は15秒以内（大量リサーチデータを考慮）

### Security
- **ファイルセキュリティ**: プロジェクトデータの適切な読み書き権限設定とバックアップ
- **API認証管理**: Claude Code認証の維持（APIキー管理不要）
- **データプライバシー**: ペルソナ情報、リサーチデータのローカル保存と適切な管理
- **アフィリエイト情報保護**: アフィリエイトID、設定情報の安全な保存と参照

### Reliability
- **オフライン動作**: Gemini MCP不使用時も手動入力でワークフロー継続可能
- **エラー耐性**: 各フェーズでの中断・復旧機能とデータ整合性保持
- **データ持続性**: 作業データの自動保存と定期的バックアップ
- **復旧機能**: ワークフロー中断からの段階的復旧とデータ修復機能

### Usability
- **CLI操作性**: 直感的なコマンド体系と豊富なヘルプ・例示機能
- **進捗可視化**: 各フェーズの進捗、推定残り時間、品質状況のテキストベース表示
- **ガイダンス**: 初回利用時のセットアップガイドと典型的ワークフローの例示
- **トラブルシューティング**: 問題発生時の診断機能と解決手順の自動提示